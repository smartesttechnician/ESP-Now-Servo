#include <esp_now.h>
#include <WiFi.h>

const int joyPinX = 34;  // ADC pin for X-axis

// Replace with receiver ESP32 MAC address
uint8_t receiverAddress[] = {0x44, 0x1D, 0x64, 0xBE, 0x39, 0x5C};

// Data structure to send
typedef struct struct_message {
    int joyX;
} struct_message;

struct_message joystickData;

void setup() {
    Serial.begin(115200);
    WiFi.mode(WIFI_STA);
    delay(100);

    // Initialize ESP-NOW
    if (esp_now_init() != ESP_OK) {
        Serial.println("Error initializing ESP-NOW");
        return;
    }

    // Add receiver as a peer
    esp_now_peer_info_t peerInfo = {};
    memcpy(peerInfo.peer_addr, receiverAddress, 6);
    peerInfo.channel = 0;
    peerInfo.encrypt = false;

    if (esp_now_add_peer(&peerInfo) != ESP_OK) {
        Serial.println("Failed to add peer");
        return;
    }

    Serial.println("Sender ready!");
}

void loop() {
    joystickData.joyX = analogRead(joyPinX);

    esp_err_t result = esp_now_send(receiverAddress, (uint8_t*)&joystickData, sizeof(joystickData));

    if (result == ESP_OK) Serial.println("Sent successfully");
    else Serial.println("Error sending data");

    delay(50); // adjust for smooth servo movement
}
// servo 
// gpio-18 to orange
// vcc to red (5v)
// brown to ground 
